<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4.1.3. Applications in UR &#8212; UncertRadio  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=b0ef843b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=59878c92" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/language_version_selector_styles.css?v=e907554d" />
    <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="4.2. Best estimates and confidence limits" href="../best_estimate.html" />
    <link rel="prev" title="4.1.2. Extension to several output quantities" href="several_output_quantities.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../../index.html">
    <img class="logo" src="../../../_static/ur2_symbol.png" alt="Logo" />
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=OpenBfS&repo=UncertRadio&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<div class="switch-menus">

    <div id="version-switch" >
        <select disabled>
            <option value="latest">latest</option>
        </select>
    </div>
    <div id="language-switch">
        <select onchange="window.location.href=this.value">
            
                <option value="#"  selected  >en</option>
            
                <option value="../../../de/doc_files/special_methods/unc_prop/applications_in_UR.html"  >de</option>
            
        </select>
    </div>
</div><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../content/content_index.html">1. Content</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/first_steps_index.html">2. User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../batch_mode/batch_mode_index.html">3. Batch mode</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../special_methods_index.html">4. Special Methods</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="uncertainty_propagation_index.html">4.1. Uncertainty propagation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="without_linear_unfolding.html">4.1.1. Methods without linear unfolding</a></li>
<li class="toctree-l3"><a class="reference internal" href="several_output_quantities.html">4.1.2. Extension to several output quantities</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">4.1.3. Applications in UR</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../best_estimate.html">4.2. Best estimates and confidence limits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../linear_least_square.html">4.3. Linear Least squares method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../calibration_curve.html">4.4. Utilizing a calibration curve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gamma_lines.html">4.5. Activity determination from several gamma lines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monte_carlo.html">4.6. Monte Carlo Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../low_level_applications.html">4.7. Low-Level Applications, (N+x)-rule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../confidence_ellipses.html">4.8. Confidence ellipses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_sets_mean.html">4.9. Using data sets for mean and variance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../short-lived_nuclide.html">4.10. Measuring a short-lived radionuclide with comparably long counting duration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../special_distributions.html">4.11. Special distributions and their properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gross_quantity.html">4.12. Gross quantity: Variance interpolation for a mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aggregating_activities.html">4.13. Aggregating activities of several aliquots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../decay_chains.html">4.14. Application of decay series</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/misc_index.html">5. Miscellaneous</a></li>
</ul>


<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="applications-in-ur">
<h1><span class="section-number">4.1.3. </span>Applications in UR<a class="headerlink" href="#applications-in-ur" title="Link to this heading">Â¶</a></h1>
<p>The case of linear unfolding is represented by several equations of the
type</p>
<p><span class="math notranslate nohighlight">\(x_{i} = \sum_{k = 1}^{n}{A_{k,i}y_{k}}\)</span> ,</p>
<p>or, in matrix notation (<strong>A</strong> contains the
<span class="math notranslate nohighlight">\(X_{i}\left( t_{k} \right)\)</span> terms):</p>
<p><span class="math notranslate nohighlight">\(\mathbf{x} = \mathbf{A\ y}\)</span></p>
<p>Now, the desired output quantities <strong>Y</strong> are found in the right side of
this equation, the input quantities on the left side. As it is well
known, the linear least squares-method yields the solution to this
problem:</p>
<div class="math notranslate nohighlight">
\[\mathbf{y =}\mathbf{U}_{\mathbf{y}}\mathbf{A}^{\mathbf{T}}\mathbf{U}_{\mathbf{x}}^{- 1}\left( \mathbf{x} \right)\mathbf{\ x}\]</div>
<div class="math notranslate nohighlight">
\[\mathbf{U}_{\mathbf{y}}\mathbf{=}\left( \mathbf{A}^{\mathbf{T}}\mathbf{U}_{\mathbf{x}}^{\mathbf{- 1}}\left( \mathbf{x} \right)\mathbf{\ A} \right)^{- 1}\]</div>
<p>In a next step it is assumed that the elements of the design matrix
<strong>A</strong>, which e.g. consist of decay corrections when analyzing a decay
curve, may contain further parameters with associated uncertainties
(given as a vector <strong>p</strong> with covariance matrix
<span class="math notranslate nohighlight">\(\mathbf{U}_{\mathbf{p}}\)</span>). Using a transformation matrix <strong>Q</strong>
containing numerically calculated partial derivatives
<span class="math notranslate nohighlight">\(Q_{i,k} = \partial Y_{i}/\partial p_{k}\)</span>, an extended version of
the covariance matrix <span class="math notranslate nohighlight">\(\mathbf{U}_{\mathbf{y}}\)</span> can be calculated
(this does not change the value of <strong>y</strong>)<strong>:</strong></p>
<div class="math notranslate nohighlight">
\[\mathbf{U}_{\mathbf{y}}\mathbf{=}\left( \mathbf{A}^{\mathbf{T}}\mathbf{U}_{\mathbf{x}}^{\mathbf{- 1}}\left( \mathbf{x} \right)\mathbf{\ A} \right)^{- 1}\mathbf{+}\mathbf{Q\ }\mathbf{U}_{\mathbf{p}}\mathbf{\ }\mathbf{Q}^{\mathbf{T}}\]</div>
<p>For every combination
<span class="math notranslate nohighlight">\(y_{i}\left( p_{k} \pm \mathrm{\Delta}p_{k} \right)\)</span> (with
<span class="math notranslate nohighlight">\(\mathrm{\Delta}p_{k} = 1 \bullet \ 10^{- 6}p_{k}\)</span>) of numerical
approximations of the partial derivatives</p>
<div class="math notranslate nohighlight">
\[Q_{ik} = \frac{\partial y_{i}}{\partial p_{k}} \approx \frac{y_{i}\left( p_{k} + \mathrm{\Delta}p_{k} \right) - y_{i}\left( p_{k} \right)}{\mathrm{\Delta}p_{k}}\]</div>
<p>the matrix <strong>A</strong>, the output vector <strong>y</strong> (its elements being considered
as functions) and the covariance matrix <span class="math notranslate nohighlight">\(\mathbf{U}_{\mathbf{p}}\)</span>
must be recalculated.</p>
<p>Alternatively, by using the chain rule for derivatives the second term
in Eq. (11) can be expressed as follows:</p>
<div class="math notranslate nohighlight">
\[\mathbf{C}_{\mathbf{P}}\mathbf{\ }\mathbf{U}_{\mathbf{p}}\mathbf{\ }\mathbf{C}_{\mathbf{p}}^{\mathbf{T}}\mathbf{=}\left( \mathbf{C}_{\mathbf{A}}\mathbf{D}_{\mathbf{P}} \right)\mathbf{U}_{\mathbf{p}}\left( \mathbf{C}_{\mathbf{A}}\mathbf{D}_{\mathbf{P}} \right)^{\mathbf{T}}\mathbf{\  =}\mathbf{C}_{\mathbf{A}}\left( \mathbf{D}_{\mathbf{P}}\mathbf{\ }\mathbf{U}_{\mathbf{p}}\mathbf{\ }\mathbf{D}_{\mathbf{p}}^{\mathbf{T}} \right)\mathbf{\ }\mathbf{C}_{\mathbf{A}}^{\mathbf{T}}\mathbf{=}\mathbf{C}_{\mathbf{A}}\mathbf{\ }\mathbf{U}_{\mathbf{A}}\mathbf{\ }\mathbf{C}_{\mathbf{A}}^{\mathbf{T}}\]</div>
<p>Herein are: <span class="math notranslate nohighlight">\(\mathbf{C}_{\mathbf{A}}\)</span> : matrix of partial
derivatives of <em>y</em><sub>i</sub> with respect to the elements of the matrix
<strong>A</strong>, <strong>Dp</strong> : matrix of partial derivatives of the elements of <strong>A</strong>
with respect to parameters <strong>p</strong>; <strong>UA</strong> : covariance matrix of the
elements of <strong>A</strong>, which are functions of <strong>p</strong>. The chain rule for
partial derivatives takes the form <strong>Cp</strong>= <strong>CAÂ·Dp</strong>, with the
property</p>
<div class="math notranslate nohighlight">
\[\mathbf{C}_{\mathbf{p}}^{\mathbf{T}}\mathbf{=}{\mathbf{D}_{\mathbf{p}}^{\mathbf{T}}\mathbf{C}}_{\mathbf{A}}^{\mathbf{T}}\]</div>
<p>Especially the expression
.. math:: mathbf{C}_{mathbf{A}}mathbf{}mathbf{U}_{mathbf{A}}mathbf{}mathbf{C}_{mathbf{A}}^{mathbf{T}}
is required within the WTLS fitting procedure; it is derived in a
subroutine which is used by both fitting methods, WLS and WTLS,
respectively. The matrix <strong>UA</strong> is calculated as indicated in the
preceding sub-chapter.</p>
<blockquote>
<div><p><strong>Note on the covariance matrix UA:</strong></p>
<p>For linear unfolding with the WTLS procedure a test had been
implemented with the previous version, which by using the Cholesky
decomposition tests whether the input covariance matrix is positive
definite. This has been improved by testing in advance of the
Cholesky decomposition the Cauchy-Schwarz inequality:</p>
<p><span class="math notranslate nohighlight">\(cov(i,k)^{2} \leq var(i)var(k)\)</span> .</p>
<p>For pairs (i, k), for which equality is found, the associated cov(i,
k) is multiplied by the factor (1-Î´) with Î´=1Â·10<sup>-09</sup>. Should
the covariance matrix after these tests again be not positive
definite (it cannot be inverted) all non-diagonal elements are
multiplied with this factor. Should this not help, the program
evaluation is interrupted with giving a hint on this problem.</p>
</div></blockquote>
<p>This primary result (i.e., the values of the fit parameters; they often
represent activity values referred to the time of measurement) of linear
may need further treatment, if the fit parameters values obtained must
be inserted into to further equations. This is the case, if the activity
value at measurement (fit parameter) needs to be divided by mass/volume
and requires and a further decay correction and these new parameters
(parameter vector <strong>q</strong>) associated with these corrections have
uncertainties (<strong>embedding linear unfolding</strong>). This often may not
require matrix algebra, if the corrections of the fit parameters
<span class="math notranslate nohighlight">\(y_{i}\)</span> consist in simply multiplying them with factors
<span class="math notranslate nohighlight">\(\varphi_{i}\ \)</span>which results in the âfinalâ output quantities
<span class="math notranslate nohighlight">\(y_{i}^{'}\)</span>:</p>
<div class="math notranslate nohighlight">
\[y_{i}^{'} = y_{i}\ \ \varphi_{i}\ \left( q,y_{k} \right)\]</div>
<p>Nevertheless, these functions may be arranged into a vector</p>
<div class="math notranslate nohighlight">
\[\mathbf{y}^{\mathbf{'}} = \left( y_{1}\left( \mathbf{q},\mathbf{y} \right),\ {\ y}_{2}\left( \mathbf{q},\mathbf{y} \right),\ \ldots,\ \ y_{n}\left( \mathbf{q},\mathbf{y} \right), \right)^{T}\]</div>
<p>Calculating the covariance matrix of <span class="math notranslate nohighlight">\(\mathbf{y}^{\mathbf{'}}\)</span> now
requires, by analogy to Eq. (11), an (<em>n</em> x <em>n</em>)-matrix
<span class="math notranslate nohighlight">\(\mathbf{J}\)</span> of partial derivatives
<span class="math notranslate nohighlight">\(J_{i,k} = \partial y_{i}^{'}/\partial y_{k}\)</span> of the functions
<span class="math notranslate nohighlight">\(y_{i}^{'}\)</span> with respect to the fitted values <span class="math notranslate nohighlight">\(y_{i}\)</span>. For
taking into account the uncertainties of the <em>n</em><sub>q</sub> values <strong>q</strong>
requires to calculate the correspondent (<em>n</em> x <em>n</em><sub>q</sub>)-matrix
<span class="math notranslate nohighlight">\(\mathbf{Q'}\)</span> of partial derivatives
<span class="math notranslate nohighlight">\({Q'}_{i,k} = \partial y_{i}^{'}/\partial q_{k}\)</span>.</p>
<p>If there are no covariances between <strong>y</strong> and <strong>q</strong>, the extended
version of Eq. (11) yields the covariance associated with the finally
desired output quantities <span class="math notranslate nohighlight">\(\mathbf{y}^{\mathbf{'}}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{U}_{\mathbf{y'}}\mathbf{=}\mathbf{J\ }\mathbf{U}_{\mathbf{y}}\mathbf{\ }\mathbf{J}^{\mathbf{T}}\mathbf{+}\mathbf{Q'\ }\mathbf{U}_{\mathbf{q}}\mathbf{\ }\mathbf{Q'}^{\mathbf{T}}\]</div>
<p>where the covariance matrix <strong>Uy</strong> is the one from (11), which then
results in:</p>
<div class="math notranslate nohighlight">
\[\mathbf{U}_{\mathbf{y'}}\mathbf{=}\mathbf{J\ }\left\{ \left( \mathbf{A}^{\mathbf{T}}\mathbf{U}_{\mathbf{x}}^{\mathbf{- 1}}\left( \mathbf{x} \right)\mathbf{\ A} \right)^{- 1}\mathbf{+}\mathbf{Q\ }\mathbf{U}_{\mathbf{p}}\mathbf{\ }\mathbf{Q}^{\mathbf{T}} \right\}\mathbf{\ }\mathbf{J}^{\mathbf{T}}\mathbf{+}\mathbf{Q'\ }\mathbf{U}_{\mathbf{q}}\mathbf{\ }\mathbf{Q'}^{\mathbf{T}}\]</div>
<p>Note: If the partial derivatives <span class="math notranslate nohighlight">\(\partial y_{i}/\partial p_{k}\)</span>
being the elements of the matrix <strong>Q</strong> (Eq. 11) are referred to the
vector <span class="math notranslate nohighlight">\(\mathbf{y}^{\mathbf{'}}\)</span>, i.e. replaced by
<span class="math notranslate nohighlight">\(\partial{y'}_{i}/\partial p_{k}\)</span>, the term
<span class="math notranslate nohighlight">\(\mathbf{Q\ }\mathbf{U}_{\mathbf{p}}\mathbf{\ }\mathbf{Q}^{\mathbf{T}}\)</span>
in Eq. (16) associated with them, hast to be removed from Eq. (16) and
moved to Eq. (15) as an additional term.</p>
<p>For further reading, see: <a class="reference external" href="#literature">Cox et al., 2004</a>.</p>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;2025, GÃ¼nter Kanisch.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../../_sources/doc_files/special_methods/unc_prop/applications_in_UR.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/OpenBfS/UncertRadio" class="github">
        <img src="../../../_static/github-banner.svg" alt="Fork me on GitHub" class="github"/>
    </a>
    

    
  </body>
</html>