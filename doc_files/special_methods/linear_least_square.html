<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4.3. Linear Least squares method &#8212; UncertRadio  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=b0ef843b" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=59878c92" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/language_version_selector_styles.css?v=e907554d" />
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.4. Utilizing a calibration curve" href="calibration_curve.html" />
    <link rel="prev" title="4.2. Best estimates and confidence limits" href="best_estimate.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/ur2_symbol.png" alt="Logo" />
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=OpenBfS&repo=UncertRadio&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<div class="switch-menus">

    <div id="version-switch" >
        <select disabled>
            <option value="latest">latest</option>
        </select>
    </div>
    <div id="language-switch">
        <select onchange="window.location.href=this.value">
            
                <option value="#"  selected  >en</option>
            
                <option value="../../de/doc_files/special_methods/linear_least_square.html"  >de</option>
            
        </select>
    </div>
</div><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../content/content_index.html">1. Content</a></li>
<li class="toctree-l1"><a class="reference internal" href="../first_steps/first_steps_index.html">2. User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../batch_mode/batch_mode_index.html">3. Batch mode</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="special_methods_index.html">4. Special Methods</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="unc_prop/uncertainty_propagation_index.html">4.1. Uncertainty propagation</a></li>
<li class="toctree-l2"><a class="reference internal" href="best_estimate.html">4.2. Best estimates and confidence limits</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">4.3. Linear Least squares method</a></li>
<li class="toctree-l2"><a class="reference internal" href="calibration_curve.html">4.4. Utilizing a calibration curve</a></li>
<li class="toctree-l2"><a class="reference internal" href="gamma_lines.html">4.5. Activity determination from several gamma lines</a></li>
<li class="toctree-l2"><a class="reference internal" href="monte_carlo.html">4.6. Monte Carlo Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="low_level_applications.html">4.7. Low-Level Applications, (N+x)-rule</a></li>
<li class="toctree-l2"><a class="reference internal" href="confidence_ellipses.html">4.8. Confidence ellipses</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_sets_mean.html">4.9. Using data sets for mean and variance</a></li>
<li class="toctree-l2"><a class="reference internal" href="short-lived_nuclide.html">4.10. Measuring a short-lived radionuclide with comparably long counting duration</a></li>
<li class="toctree-l2"><a class="reference internal" href="special_distributions.html">4.11. Special distributions and their properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="gross_quantity.html">4.12. Gross quantity: Variance interpolation for a mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="aggregating_activities.html">4.13. Aggregating activities of several aliquots</a></li>
<li class="toctree-l2"><a class="reference internal" href="decay_chains.html">4.14. Application of decay series</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../misc/misc_index.html">5. Miscellaneous</a></li>
</ul>


<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="linear-least-squares-method">
<h1><span class="section-number">4.3. </span>Linear Least squares method<a class="headerlink" href="#linear-least-squares-method" title="Link to this heading">¶</a></h1>
<p><strong>Principle of the multi-linear least squares fitting</strong></p>
<p><strong>Model</strong></p>
<p>For the use of the (multi-) linear least squares fitting (LSQ analysis)
the following model of a decay curve is assumed:</p>
<div class="math notranslate nohighlight">
\[Y\left( t_{k} \right) = a_{1} \cdot X_{1}\left( t_{k} \right) + \ a_{2} \cdot X_{2}\left( t_{k} \right) + \ a_{3} \cdot X_{3}\left( t_{k} \right)\]</div>
<p>A sum of up to three terms being dependent on the counting time
<span class="math notranslate nohighlight">\(t_{k}\)</span> can be fitted to measured values of the quantity <em>Y</em> being
also dependent on <span class="math notranslate nohighlight">\(t_{k}\)</span>; <em>k</em> counts the measurements. The
<span class="math notranslate nohighlight">\(a_{i}\)</span> are the coefficients which are to be determined by fitting
(fitting parameters). The quantities <span class="math notranslate nohighlight">\(X_{i}\left( t_{k} \right)\)</span>
are functions (decay curves) which are considered to be known and which
depend only on <span class="math notranslate nohighlight">\(t_{k}\)</span> and other parameters, e.g., half-lives,
which are not considered as fit parameters. They must not be dependent
on the fitting parameters <span class="math notranslate nohighlight">\(a_{i}\)</span>. <span class="math notranslate nohighlight">\(Y\left( t_{k} \right)\)</span>
is treated as dependent variable while the functions
<span class="math notranslate nohighlight">\(X_{i}\left( t_{k} \right)\)</span> are treated as independent variables
in the LSQ analysis. For the moment it is assumed here that the
measurement of the values of<span class="math notranslate nohighlight">\(Y\left( t_{k} \right)\)</span> is done with
a single-channel counter.</p>
<p>By the introduction of up to three output quantities to be treated
simultaneously, it is, for instance, possible that the simultaneous
measurement of several radionuclides is done by using a two- or
three-channel counter. Using a LSC counter with three counting channels
(energy regions) allows for instance to determine simultaneously the
activities of Sr-90, Sr-89 and Sr-85 (yield tracer).</p>
<p>If more than one output quantity is defined for a project, e.g., two or
three representing the activities of different radionuclides, the
program inserts three new symbols, Fitp1, Fitp2 and Fitp3, into the list
of symbols, which refer to the values of the <span class="math notranslate nohighlight">\(a_{i}\)</span>. These names
are not allowed to be changed. From these, the user can derive with
further equations (in the text window under the TAB “Equations”) above
the <em>Linfit</em> call the decay corrected activity concentrations. Under the
TAB “Values, uncertainties” standard uncertainties obtained from the
linear curve fitting are assigned to these new symbols. Additionally,
their possible correlation pairs and associated correlation coefficients
are inserted into the corresponding table under the same TAB which
enables their whole covariance matrix of the three fitting parameters to
be used for the uncertainty propagation of the output quantities.</p>
<p>Note, that also in the case of only two output quantities all three
symbols, Fitp1, Fitp2 and Fitp3, are inserted into the symbol list.
Only, <strong>if only one output quantity</strong> is defined, <strong>none</strong> of these
parameters is inserted in the symbol list. In this case the value of the
fitting parameter is attributed directly the quantity <em>Rn</em> in the call
<em>Rn = Linfit(1,… )</em>; c.f. further down.</p>
<p><strong>Least squares routines used In UncertRadio</strong></p>
<p>Two different routines are used in the program for least squares
estimation. These are:</p>
<ul class="simple">
<li><p>the <strong>“simple“</strong> least squares procedure (LSQ) which is usually used if
the values <span class="math notranslate nohighlight">\(X_{i}\left( t_{k} \right)\)</span> <strong>do not</strong> have
uncertainties; the measured values
<span class="math notranslate nohighlight">\(Y\left( t_{k} \right)\)</span>, however, have uncertainties,
covariances between them are also taken into account. If the
values <span class="math notranslate nohighlight">\(X_{i}\left( t_{k} \right)\)</span> nevertheless have
uncertainties, they are included by UncertRadio within the
uncertainty propagation outside the LLSQ routine;</p></li>
<li><p>In autumn 2013, three options for selecting a fitting procedure were
introduced, which differ in their associated Chi-square
expressions:</p></li>
<li><p><strong>WLS</strong>: Using the <strong>Neyman Chi-square</strong>; this procedure is identical
to the previous procedure NLSQ; linear, without iterations;</p></li>
</ul>
<blockquote>
<div><p><strong>PLSQ</strong>: Using the <strong>Pearson Chi-square</strong>; linear / iteratively;</p>
<p><strong>PMLE</strong>: Poisson Maximum Likelihood Estimation (Poisson MLE);
non-linear / iteratively.</p>
</div></blockquote>
<ul class="simple">
<li><p>the <strong>“general case“</strong> of least squares (WTLS, weighted total least
squares), which in addition considers uncertainties of the
<span class="math notranslate nohighlight">\(X_{i}\left( t_{k} \right)\)</span> and possible covariances
between them. Herein, an iterative, i.e., non-linear, matrix
procedure is used, which is a more time-consuming method because
of the iterations. The possible covariances between the
<span class="math notranslate nohighlight">\(X_{i}\left( t_{k} \right)\)</span> values are determined by the
program internally by applying partial derivatives with respect to
the symbols contained in the <span class="math notranslate nohighlight">\(X_{i}\left( t_{k} \right)\)</span>
functions; they need not to be supplied by the user.</p></li>
</ul>
<p>For the background information of these fitting methods see section <a class="reference internal" href="../misc/math_lsq_fit.html#chi-square-options"><span class="std std-ref">Chi-square options</span></a>.</p>
<p>By default, the “simpler” WLS procedure is invoked by the call <em>Rn =
Linfit(1,… )</em>. The use of the WTLS procedure may be selected within the
dialog Definition of the decay-curve model.</p>
<p><strong>Notes:</strong></p>
<blockquote>
<div><p><strong>Correlations between measured values</strong>
<span class="math notranslate nohighlight">\(Y\left( t_{k} \right)\)</span> <strong>may occur.</strong> This for instance is the
case if the measured values <span class="math notranslate nohighlight">\(Y\left( t_{k} \right)\)</span> are net
counting rates for which the same value of a background counting rate
<span class="math notranslate nohighlight">\(R_{0}\)</span> as well as the net blank counting rate <span class="math notranslate nohighlight">\(R_{bl}\)</span>
have been subtracted from the corresponding gross counting rates.
These covariances - they can be calculated internally from a formula
- need to be considered especially in the case of quite low net
counting rates.</p>
<p>In the case of the net counting rates (<span class="math notranslate nohighlight">\(Y\left( t_{k} \right)\)</span>)
the covariance formula between two of its values is given by:</p>
<p><span class="math notranslate nohighlight">\(cov\left( Y\left( t_{i} \right),\ \ \ Y\left( t_{k} \right) \right) = var\left( R_{0,i} \right) + var\left( R_{bl} \right)\)</span>
.</p>
<p>This is internally used in the program to derive the complete
covariance matrix to be used by the fitting routine. In this
equation, <span class="math notranslate nohighlight">\(var\left( R_{0,i} \right)\)</span> must be set equal to zero
if either <span class="math notranslate nohighlight">\(R_{0,i}\)</span> and <span class="math notranslate nohighlight">\(R_{0,k}\)</span> are different or their
uncertainties.</p>
<p>It has to be mentioned here that for this method the background
counting rate can be defined in the special <a class="reference internal" href="../misc/dialog_def_curve_model.html#dialog-definition-of-the-decay-curve-model"><span class="std std-ref">input dialog for decay
curves</span></a> counting rate of the curve
an individual background counting rate may
be given – this may occur with LSC measurements –, or one single
value of the background counting rate (<span class="math notranslate nohighlight">\(R_{0}\)</span>) may be used for
the whole curve. <span class="math notranslate nohighlight">\(R_{0}\)</span> must contain only the detector-related
background component.</p>
<p>Furthermore, a counting rate <span class="math notranslate nohighlight">\(R_{bl}\)</span> is required which refers
to a chemical blank analysis where the detector background component
is already subtracted. Therefore, <span class="math notranslate nohighlight">\(R_{bl}\)</span> is considered as a
„net blank count rate“; it quantifies the background due to chemicals
and glassware used during an analysis. The symbol <em>Rbl</em>, with value
and uncertainty, is part of the table under the TAB “Values,
uncertainties”, the values of which are transferred by the Linfit
Call (c.f. further down in this theme) to this numeric routine.</p>
</div></blockquote>
<p>For the mathematics see:</p>
<ol class="loweralpha simple">
<li><p><a class="reference internal" href="../misc/math_lsq_fit.html#mathematics-of-the-linear-lsq-curve-fitting-with-correlated-measured-values"><span class="std std-ref">linear curve fitting with
WLS</span></a></p></li>
<li><p><a class="reference internal" href="../misc/note_wtls.html#notes-on-linear-curve-fitting-using-general-least-squares-wtls"><span class="std std-ref">linear curve fitting with WTLS</span></a></p></li>
</ol>
<p>Definition of the model: see <a class="reference internal" href="../misc/dialog_def_curve_model.html#dialog-definition-of-the-decay-curve-model"><span class="std std-ref">Dialog Definition of the decay curve model</span></a>.</p>
<p>After having defined the Linfit-Call within the equations, the use of
the WTLS procedure may be selected in this dialog.</p>
<p><strong>Activating the (multi-) linear Least squares fitting</strong></p>
<p>This is shown for two examples of different complexity.</p>
<ol class="arabic simple">
<li><p><strong>Simple example:</strong></p></li>
</ol>
<p><em>Assumtion</em>:</p>
<p>Number of output quantities: 1; from the LSQ fitting a net counting rate
<em>Rn</em> is obtained.</p>
<p>Within the text field for equations at the location where otherwise the
net counting rate <em>Rn</em> is defined, for instance</p>
<p><em>Rn = Rg – R0 ,</em></p>
<p>this equation is replaced by the following:</p>
<p><em>Rn = Linfit(1, Rbl, HwzY90, Hwzlong, HwzAc228, tmess, tstart)</em></p>
<p><strong>Linfit</strong> is the name of the procedure which initiates the LSQ fitting
with its associated sub-dialogs. Its parameters are:</p>
<blockquote>
<div><p><em>1</em>   No. of the variant of this measurement evaluation task for which
this type of fitting shall be used; at present not more than the
present variant of the evaluation of an Y-90 decay curve analysis
exists;</p>
<p><em>R0</em>   background counting rate including also blank contributions
which is subtracted from the measured Y-90 gross counting rates, in
<span class="math notranslate nohighlight">\(s^{- 1}\)</span>;</p>
<p><em>t0</em>   counting time of the background measurement, in <span class="math notranslate nohighlight">\(s\)</span>;</p>
<p><em>HwzY90</em>   half-live of Y-90, in <span class="math notranslate nohighlight">\(s\)</span></p>
<p><em>Hwzlong</em>   half-live of a longer-lived radionuclide contributing to a
(slowly decaying) background, in <span class="math notranslate nohighlight">\(s\)</span>; e.g. Th-234; if Hwzlong =
0 is set the associated decay factor is set internally equal to 1</p>
<p><em>HwzAc228</em>   half-live of the possibly interfering radionuclide Ac-228,
in <span class="math notranslate nohighlight">\(s\)</span><em>;</em> this cal also simulated a contribution of
short-lived radon decay products</p>
<p><em>tmess</em>   place holder for the counting times of the individual
counting times belonging to the net counting rates</p>
<p><em>tstart</em>   place holder for the periods of time between the time of the
Y-90/Sr-90 separation and the starting time of the individual
measurements</p>
</div></blockquote>
<p><strong>Note:</strong> Since version 2.4.24, only the three parameters <em>Rbl, tmess</em>
and <em>tstart</em> shall be given in the Linfit call: <em>Rn = Linfit(1, Rbl,
tmess, tstart)</em></p>
<p>After loading the symbols from the equations including that Linfit-call
described above the symbols from this routine are available in the
common list of symbols. In the TAB “Values, uncertainties” values and
uncertainties of the symbols <em>R0, t0, HwzY90, Hwzlong</em> and <em>HwzAc228</em>
have to be entered then, however, not for <em>tmess</em> and <em>tstart</em>.</p>
<p>With one exception, of course, one may use other Linfit symbols instead
of those shown above, they only need to be given in the total symbol
list; these symbols are to be considered “globally” valid.</p>
<p>Important: Only the symbol names <em>Rbl</em>, <em>tmess</em> and <em>tstart</em> must not be
changed, which is also true for their meaning as defined above.</p>
<p>After the call to Linfit, the value of the fitting parameter
<span class="math notranslate nohighlight">\(a_{1}\)</span> and its uncertainty have been transferred to those of the
symbol <em>Rn</em>.</p>
<ol class="arabic simple" start="2">
<li><p><strong>More complex example:</strong></p></li>
</ol>
<p><em>Assumtion</em>:</p>
<p>Number of output quantities: 3; as a result from the LSQ fitting one
obtains the fitting parameters Fitp1, Fitp2 and Fitp3, corresponding to
the parameters <span class="math notranslate nohighlight">\(a_{i}\)</span>, which now represent the activities (in Bq) of
Sr-89, Sr-90 and Sr-85. This is an example taken from the example
project DWD-LSC-3kanal-V2.txp.</p>
<p>Within the text field for equations at the location where otherwise the
net counting rate <em>Rn</em> is defined, for instance</p>
<p><em>Rn = Rg – R0,</em></p>
<p>this equation is replaced by the following:</p>
<p><em>rd = Linfit(1, Rbl, eSr85A, eSr85B, eSr85C, eSr90A, eSr90B, eSr90C,
eSr89A, eSr89B, &amp;</em></p>
<p><em>eSr89C, eY90A, eY90B, eY90C, lamSr85, lamSr90, lamSr89, lamY90, tmess,
tstart )</em></p>
<p><strong>since version 2.4.24</strong> <em>this is shortened to:</em> <em>Rn = Linfit(1, Rbl,
tmess, tstart).</em></p>
<p>The meaning of the symbols is equivalent to those in the „simple
example” given above. The symbol names <em>Rbl</em>, <em>tmess</em> and <em>tstart</em> as
well as their associated meaning must not be changed. The symbols
<em>eNuklidX</em> (in total 9) designate detection efficiencies of the
different radionuclides for the counting channels A, B or C. The
ssymbols <em>lamNuklid</em> represent the decay constants of the three
radionuclides.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Apart from the fixed symbols <em>Rbl</em>, <em>tmess</em> and <em>tstart,</em> which have to
appear in the Linfit call, neither the names of other symbols are fixed
nor their number; however, they must appear in the whole (global) symbol
list. They must be used in the equations defining the functions
<span class="math notranslate nohighlight">\(X_{i}\left( t_{k} \right)\)</span>; for more information, see also
<a class="reference external" href="#dialog-definition-of-the-decay-curve-model">Dialog Definition of the decay-curve
model</a>.</p>
</div>
<p>For Input of data from the decay curve see: <a class="reference internal" href="../misc/dialog_decay_curve.html#dialog-values-of-decay-curve"><span class="std std-ref">Dialog “Values of decay curve”</span></a>.</p>
<p><a class="reference internal" href="../misc/lsq_fit_results.html#viewing-the-result-from-the-lsq-fit-to-the-decay-curve"><span class="std std-ref">Viewing the result from the LSQ fit to the decay curve</span></a></p>
<p><a class="reference internal" href="../misc/note_dt_dl_fit.html#note-on-decision-threshold-and-detection-limit-for-linear-fitting"><span class="std std-ref">Note on Decision threshold and Detection limit for linear fitting</span></a></p>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;2025, Günter Kanisch.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 9.1.0</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../_sources/doc_files/special_methods/linear_least_square.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/OpenBfS/UncertRadio" class="github">
        <img src="../../_static/github-banner.svg" alt="Fork me on GitHub" class="github"/>
    </a>
    

    
  </body>
</html>