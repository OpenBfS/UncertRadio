<!DOCTYPE html>

<html lang="de" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4.14. Application of decay series &#8212; UncertRadio  Dokumentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=b0ef843b" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=59878c92" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/language_version_selector_styles.css?v=e907554d" />
    <script src="../../_static/documentation_options.js?v=245627df"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/translations.js?v=9bf55d28"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Stichwortverzeichnis" href="../../genindex.html" />
    <link rel="search" title="Suche" href="../../search.html" />
    <link rel="next" title="5. Verschiedenes" href="../misc/misc_index.html" />
    <link rel="prev" title="4.13. Aggregating activities of several aliquots" href="aggregating_activities.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/ur2_symbol.png" alt="Logo" />
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=OpenBfS&repo=UncertRadio&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<div class="switch-menus">

    <div id="version-switch" >
        <select disabled>
            <option value="latest">latest</option>
        </select>
    </div>
    <div id="language-switch">
        <select onchange="window.location.href=this.value">
            
                <option value="../../../doc_files/special_methods/decay_chains.html"  >en</option>
            
                <option value="#"  selected  >de</option>
            
        </select>
    </div>
</div><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../content/content_index.html">1. Inhalt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../first_steps/first_steps_index.html">2. Erste Schritte</a></li>
<li class="toctree-l1"><a class="reference internal" href="../batch_mode/batch_mode_index.html">3. Automatisierung</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="special_methods_index.html">4. Einzelne Methoden</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="unc_prop/uncertainty_propagation_index.html">4.1. Uncertainty propagation</a></li>
<li class="toctree-l2"><a class="reference internal" href="best_estimate.html">4.2. Best estimates and confidence limits</a></li>
<li class="toctree-l2"><a class="reference internal" href="linear_least_square.html">4.3. Linear Least squares method</a></li>
<li class="toctree-l2"><a class="reference internal" href="calibration_curve.html">4.4. Utilizing a calibration curve</a></li>
<li class="toctree-l2"><a class="reference internal" href="gamma_lines.html">4.5. Activity determination from several gamma lines</a></li>
<li class="toctree-l2"><a class="reference internal" href="monte_carlo.html">4.6. Monte Carlo Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="low_level_applications.html">4.7. Low-Level Applications, (N+x)-rule</a></li>
<li class="toctree-l2"><a class="reference internal" href="confidence_ellipses.html">4.8. Confidence ellipses</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_sets_mean.html">4.9. Using data sets for mean and variance</a></li>
<li class="toctree-l2"><a class="reference internal" href="short-lived_nuclide.html">4.10. Measuring a short-lived radionuclide with comparably long counting duration</a></li>
<li class="toctree-l2"><a class="reference internal" href="special_distributions.html">4.11. Special distributions and their properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="gross_quantity.html">4.12. Gross quantity: Variance interpolation for a mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="aggregating_activities.html">4.13. Aggregating activities of several aliquots</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">4.14. Application of decay series</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basic-procedure">4.14.1. Basic procedure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#decay-corrections">4.14.2. Decay corrections</a></li>
<li class="toctree-l3"><a class="reference internal" href="#impact-on-the-decision-threshold-and-the-detection-limit">4.14.3. Impact on the decision threshold and the detection limit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implementation-of-decay-chains-in-uncertradio">4.14.4. Implementation of decay chains in UncertRadio</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-project">4.14.5. Example project</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generation-of-decay-factor-formulas">4.14.6. Generation of decay factor formulas</a></li>
<li class="toctree-l3"><a class="reference internal" href="#decay-chain-literature">4.14.7. Decay Chain Literature</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../misc/misc_index.html">5. Verschiedenes</a></li>
</ul>


<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Los" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="application-of-decay-series">
<h1><span class="section-number">4.14. </span>Application of decay series<a class="headerlink" href="#application-of-decay-series" title="Link to this heading">¶</a></h1>
<section id="basic-procedure">
<h2><span class="section-number">4.14.1. </span>Basic procedure<a class="headerlink" href="#basic-procedure" title="Link to this heading">¶</a></h2>
<p>The time behaviour of atom numbers <span class="math notranslate nohighlight">\(N_{i}(t)\)</span> of the radionuclides
(members) of a decay chain is in principle modelled by a system of first
order differential equations. They are called the Bateman equations
after H. Bateman’s publication of 1910. Their solution led to atom
numbers <span class="math notranslate nohighlight">\(N_{i}(t &gt; 0)\)</span>, which by radioactive decay can be expected
after a time duration <span class="math notranslate nohighlight">\(t\)</span> from the atom number
<span class="math notranslate nohighlight">\(N_{i}(t = 0)\)</span> at <span class="math notranslate nohighlight">\(t = 0\)</span>.</p>
<p>More recent work on improved solutions for such a system applies
matrix-based methods, which are applicable in an automated way also for
more complex decay chains. The method published by E. Levy in 2019 was
chosen for UncertRadio, more specifically the <span class="math notranslate nohighlight">\(\mathbf{F}\)</span>-Matrix
introduced in chapter 4 of his publication. It was found that the result
of a series expansion of an exponential function of a decay matrix as
used before lead to a single matrix, the <span class="math notranslate nohighlight">\(\mathbf{F}\)</span>-Matrix. In
environmental radioactivity mainly the activities of radionuclides are
of interest instead of their atom numbers. The general relation
<span class="math notranslate nohighlight">\(A_{i} = \lambda_{i} \cdot N_{i}\)</span> between activity and atom
numbers allows to derive an <span class="math notranslate nohighlight">\(\mathbf{F}\)</span>-Matrix for activities.
The rank of the matrix is equal to the number of members of decay chain,
denoted as <span class="math notranslate nohighlight">\(L.\)</span> In his chapter 4, Levy derived an algorithm for
calculating the elements of the matrix <span class="math notranslate nohighlight">\(\mathbf{F}\)</span>, which is of
left-triangular shape. An important feature of <span class="math notranslate nohighlight">\(\mathbf{F}\)</span> is
that it holds only for the given time <span class="math notranslate nohighlight">\(t\)</span>; for any other time
value, <span class="math notranslate nohighlight">\(\mathbf{F}\)</span> always has to be re-computed.</p>
<p>For calculating the elements of the <span class="math notranslate nohighlight">\(\mathbf{F}\ m\)</span>atrix only
the decay constants <span class="math notranslate nohighlight">\(\lambda_{i}\)</span> and the values of branching
ratios <span class="math notranslate nohighlight">\(z_{j,i}\)</span> (mit <span class="math notranslate nohighlight">\(j &lt; i\)</span>) of the radionuclides are
required. The latter are stored in a separate matrix of rank <span class="math notranslate nohighlight">\(L\)</span>.
After initialisation of this matrix by zero, only those elements
<span class="math notranslate nohighlight">\((i,j)\)</span> are set for which <span class="math notranslate nohighlight">\(z_{j,i} &gt; 0\)</span> holds. For a decay
chain of length <span class="math notranslate nohighlight">\(L\)</span> and without branching just <span class="math notranslate nohighlight">\(L - 1\)</span>
values <span class="math notranslate nohighlight">\(z_{j,i}\)</span> exist. The diagonal elements of the matrix
<span class="math notranslate nohighlight">\(\mathbf{F}\)</span> contain decay factors
<span class="math notranslate nohighlight">\(\exp\left( - \lambda_{i}t \right)\)</span> (without correcting decay
during the measurement duration <span class="math notranslate nohighlight">\(t_{m}\)</span>) or function values
<span class="math notranslate nohighlight">\(fd(t,tm,xlam)\)</span> (with correcting decay during the measurement; see
<a class="reference internal" href="../misc/text_fields_equations.html#text-field-for-equations"><span class="std std-numref">Abschnitt 5.8</span></a>).</p>
<p>For a vector <span class="math notranslate nohighlight">\(\mathbf{a}_{\mathbf{0}}\)</span> of start activity values
given at <span class="math notranslate nohighlight">\(t = 0\)</span>, the vector <span class="math notranslate nohighlight">\(\mathbf{a}_{\mathbf{t}}\)</span> of
activities after the time duration <span class="math notranslate nohighlight">\(t &gt; 0\)</span> is calculated by matrix
multiplication:</p>
<div class="math notranslate nohighlight" id="equation-eq-decay-chains-1">
<span class="eqno">(4.14.1)<a class="headerlink" href="#equation-eq-decay-chains-1" title="Link to this equation">¶</a></span>\[\mathbf{a}_{\mathbf{t}} = \mathbf{F} \cdot \mathbf{a}_{\mathbf{0}}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix}
A_{1}(t) \\
A_{2}(t) \\
\begin{matrix}
 \vdots \\
A_{n}(t)
\end{matrix}
\end{pmatrix} = \begin{pmatrix}
f_{1,1} &amp; 0 &amp; 0 &amp; 0 \\
f_{2,1} &amp; f_{2,2} &amp; 0 &amp; 0 \\
 \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
f_{n,1} &amp; f_{n,2} &amp; \cdots &amp; f_{n,n}
\end{pmatrix} \cdot \begin{pmatrix}
A_{1}(0) \\
A_{2}(0) \\
\begin{matrix}
 \vdots \\
A_{n}(0)
\end{matrix}
\end{pmatrix}\end{split}\]</div>
<p>For the application in UR this is called „forward calculation“. The
activity unit used in this equation must be Bq.</p>
<p>When specific activities are to be considered, it must be observed that
the associated calibration factors relating count rates to specific
activities must not contain such decay corrections which are already
part of <span class="math notranslate nohighlight">\(\mathbf{F}\)</span>. If this condition is fulfilled, the matrix
equation given above can also be applied for specific activities. The
matrix <span class="math notranslate nohighlight">\(\mathbf{F}\)</span> in that case remains the same.</p>
</section>
<section id="decay-corrections">
<h2><span class="section-number">4.14.2. </span>Decay corrections<a class="headerlink" href="#decay-corrections" title="Link to this heading">¶</a></h2>
<p>The vector <span class="math notranslate nohighlight">\(\mathbf{a}_{\mathbf{t}}\ \)</span>is calculated from
<span class="math notranslate nohighlight">\(\mathbf{a}_{\mathbf{0}}\)</span> by <a class="reference internal" href="#equation-eq-decay-chains-1">(4.14.1)</a>; this step was called
„forward calculation”. If the decay chain has only radionuclide decaying
to a stable isotope, the inversion of this step („backward
calculation“)is often termed „decay correction“: it means the ratio
<span class="math notranslate nohighlight">\(a_{1}(0)/a_{1}(t)\)</span>. The activity determined at the time of
measurement is back calculated to the date of sampling.</p>
<p>For decay chains of two or more members, the backward calculation
becomes more complicated. As an example, consider the decay chain
Pb-210/Bi-210/Po-210. The non-trivial problem now consists in deriving
the Pb-210 activity at the time of sampling from measurements of the
later measurements of the decay products.</p>
<p>For the most elegant solution method of this task, the <a class="reference internal" href="#equation-eq-decay-chains-1">(4.14.1)</a> is
interpreted as a linear least squares problem. The matrix
<span class="math notranslate nohighlight">\(\mathbf{F}\)</span> is considered as the design matrix and the vector
<span class="math notranslate nohighlight">\(\mathbf{a}_{\mathbf{0}}\)</span> is treated as the desired solution
vector. The vector <span class="math notranslate nohighlight">\(\mathbf{a}_{\mathbf{t}}\)</span> represents the
measurements. A covariance matrix
<span class="math notranslate nohighlight">\(\mathbf{U}_{\mathbf{a}_{\mathbf{t}}}\)</span> can be established
associated with <span class="math notranslate nohighlight">\(\mathbf{a}_{\mathbf{t}}\)</span>. We assume that this
matrix is diagonal.</p>
<p>Under these assumptions the least squares problem can be solved by the
following two equations (see CHAGR-ISO-01, section 4.2):</p>
<div class="math notranslate nohighlight" id="equation-eq-decay-chains-2">
<span class="eqno">(4.14.2)<a class="headerlink" href="#equation-eq-decay-chains-2" title="Link to this equation">¶</a></span>\[\mathbf{U}_{\mathbf{a}_{\mathbf{0}}} = \left( \mathbf{F}^{T} \cdot \mathbf{U}_{\mathbf{a}_{\mathbf{t}}}^{- \mathbf{1}}\mathbf{\cdot}\mathbf{F} \right)^{- 1}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-decay-chains-3">
<span class="eqno">(4.14.3)<a class="headerlink" href="#equation-eq-decay-chains-3" title="Link to this equation">¶</a></span>\[\mathbf{a}_{\mathbf{0}} = \mathbf{U}_{\mathbf{a}_{\mathbf{0}}} \cdot \mathbf{F}^{T} \cdot \mathbf{U}_{\mathbf{a}_{\mathbf{t}}}^{- \mathbf{1}} \cdot \mathbf{a}_{\mathbf{t}}\]</div>
<p>The computation of these equations is easily done. The advantage of
these equations is that the vector <span class="math notranslate nohighlight">\(\mathbf{a}_{\mathbf{0}}\)</span> and
the associated covariance matrix
<span class="math notranslate nohighlight">\(\mathbf{U}_{\mathbf{a}_{\mathbf{0}}}\)</span> are practically obtained by
the same combined step.</p>
<p>Alternatively, a recursion procedure can be applied. According to the
literature [Blobel, Lohrmann, chapter 3.4, Press at al., 1992, section
2.3], the elements of the vector <span class="math notranslate nohighlight">\(\mathbf{a}_{\mathbf{0}}\)</span> are
calculated by a recursive scheme („forward substitution“) from the left
triangular matrix (<span class="math notranslate nohighlight">\(\mathbf{F}\)</span>). The scheme is described by the
following equations:</p>
<div class="math notranslate nohighlight">
\[{k = 1:\ \ \ \ \ \ \ \ \ a}_{0;1} = \frac{a_{t;1}}{f_{1,1}}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-decay-chains-4">
<span class="eqno">(4.14.4)<a class="headerlink" href="#equation-eq-decay-chains-4" title="Link to this equation">¶</a></span>\[k &gt; 1:\ \ \ \ \ \ \ \ \  a_{0;k} = \frac{1}{f_{k,k}}\left\lbrack a_{t;k} - \sum_{j = 1}^{k - 1}\left( f_{k,j} \cdot a_{0;j} \right) \right\rbrack\]</div>
<p>Before calculating the uncertainties, the components <span class="math notranslate nohighlight">\(a_{0;j}\)</span> of
<span class="math notranslate nohighlight">\(\mathbf{a}_{\mathbf{0}}\)</span> in the right-hand side of the equation
for <span class="math notranslate nohighlight">\(k &gt; 1\)</span> need to be substituted by corresponding components of
the vector <span class="math notranslate nohighlight">\(\mathbf{a}_{\mathbf{t}}\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-eq-decay-chains-5">
<span class="eqno">(4.14.5)<a class="headerlink" href="#equation-eq-decay-chains-5" title="Link to this equation">¶</a></span>\[a_{0;j} = A_{k}(0) = \sum_{i = 1}^{k}{d_{k,i} \cdot A_{i}(t)}\]</div>
<p>The calculations according to <a class="reference internal" href="#equation-eq-decay-chains-5">(4.14.5)</a>,
which may become more tedious for
longer decay chains, are simplified by the LS procedure. The
coefficients <span class="math notranslate nohighlight">\(d_{j,i}\)</span> formally define a matrix
<span class="math notranslate nohighlight">\(\mathbf{D}\)</span>, which can be established by <a class="reference internal" href="#equation-eq-decay-chains-3">(4.14.3)</a>:</p>
<div class="math notranslate nohighlight" id="equation-eq-decay-chains-6">
<span class="eqno">(4.14.6)<a class="headerlink" href="#equation-eq-decay-chains-6" title="Link to this equation">¶</a></span>\[\mathbf{D} = \mathbf{U}_{\mathbf{a}_{\mathbf{0}}} \cdot \mathbf{F}^{T} \cdot \mathbf{U}_{\mathbf{a}_{\mathbf{t}}}^{- \mathbf{1}}\]</div>
<p>The equations <a class="reference internal" href="#equation-eq-decay-chains-5">(4.14.5)</a> and <a class="reference internal" href="#equation-eq-decay-chains-6">(4.14.6)</a>
formulated for a 3-member decay chain are:</p>
<div class="math notranslate nohighlight">
\[A_{1}(0) = d_{1,1} \cdot A_{1}(t)\]</div>
<div class="math notranslate nohighlight" id="equation-eq-decay-chains-7">
<span class="eqno">(4.14.7)<a class="headerlink" href="#equation-eq-decay-chains-7" title="Link to this equation">¶</a></span>\[A_{2}(0) = d_{2,1} \cdot A_{1}(t) + d_{2,2} \cdot A_{2}(t)\]</div>
<div class="math notranslate nohighlight">
\[A_{3}(0) = d_{3,1} \cdot A_{1}(t) + d_{3,2} \cdot A_{2}(t) + d_{3,3} \cdot A_{3}(t)\]</div>
<p><a class="reference internal" href="#equation-eq-decay-chains-5">(4.14.5)</a> can be re-formulated as follows by tracing back the
uncertainties of <span class="math notranslate nohighlight">\(A_{i}(t)\)</span> to the uncertainties of the input
quantities <span class="math notranslate nohighlight">\(x_{j}\)</span>:</p>
<div class="math notranslate nohighlight">
\[u^{2}\left( A_{k}(0) \right) = \sum_{i = 1}^{k}{d_{k,i}^{2} \cdot u^{2}\left( A_{i}(t) \right)}\]</div>
<div class="math notranslate nohighlight">
\[u^{2}\left( A_{k}(0) \right) = \sum_{i = 1}^{k}{d_{k,i}^{2} \cdot \sum_{j}^{}\left( \frac{\partial A_{i}(t)}{{\partial x}_{j}} \right)^{2}u^{2}\left( x_{j}(t) \right)}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-decay-chains-8">
<span class="eqno">(4.14.8)<a class="headerlink" href="#equation-eq-decay-chains-8" title="Link to this equation">¶</a></span>\[u^{2}\left( A_{k}(0) \right) = \sum_{j}^{}{u^{2}\left( x_{j}(t) \right)}\sum_{i = 1}^{k}\left( d_{k,i} \cdot \frac{\partial A_{i}(t)}{{\partial x}_{j}} \right)^{2}\]</div>
<p>This means, the sensitivity coefficients of the uncertainty propagation
are multiplied by factors <span class="math notranslate nohighlight">\(d_{k,i}\)</span> multipliziert. Dependent on
the size of <span class="math notranslate nohighlight">\(d_{k,i}\)</span>, these factors have the potential to raise
the uncertainties of <span class="math notranslate nohighlight">\(A_{k}(0)\)</span>. For the example of the decay
chain Pb-210/Bi-210/Po-210, this effect increases by increasing the time
interval <span class="math notranslate nohighlight">\(t\)</span> relative to the half-live of Bi-210.</p>
<p>UncertRadio contains the code for calculating <span class="math notranslate nohighlight">\(\mathbf{F}\)</span> and the
<a class="reference internal" href="#equation-eq-decay-chains-1">(4.14.1)</a> through <a class="reference internal" href="#equation-eq-decay-chains-8">(4.14.8)</a>.</p>
</section>
<section id="impact-on-the-decision-threshold-and-the-detection-limit">
<h2><span class="section-number">4.14.3. </span>Impact on the decision threshold and the detection limit<a class="headerlink" href="#impact-on-the-decision-threshold-and-the-detection-limit" title="Link to this heading">¶</a></h2>
<p>The ISO 11929-related procedure for deriving the decision threshold and
the detection limit needs to be modified in the case of the decay
corrections for a decay chain. This is explained for the decay chain
Pb-210/Bi-210/Po-210, for which the activity <em>A1</em>(<em>0</em>) of the first
member of the chain shall be calculated. The common relation <em>A1</em>(<em>0</em>)
=w*<em>Rn</em> between activity and net count rate does no longer apply,
because this activity originates from two count rates, those of Bi-210
and Po-210.</p>
<p>The corresponding relation shall be modelled by an equation like
<em>A1</em>(<em>0</em>)= <em>w1</em>*<em>Rn1</em> + <em>w2</em>*<em>Rn2.</em> A modified or assumed
activity <span class="math notranslate nohighlight">\(\widetilde{A}\)</span> of the output quantity is obtained by
multiplying the primary values <span class="math notranslate nohighlight">\(A_{1}(0)\)</span> by a “modifying factor”
<span class="math notranslate nohighlight">\(\widetilde{q}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-decay-chains-9">
<span class="eqno">(4.14.9)<a class="headerlink" href="#equation-eq-decay-chains-9" title="Link to this equation">¶</a></span>\[\widetilde{A} = \widetilde{q} \cdot A_{1}(0) = w_{1} \cdot \left( R_{n1} \cdot \widetilde{q} \right) + w_{1} \cdot \left( R_{n1} \cdot \widetilde{q} \right) = w_{1} \cdot {\widetilde{R}}_{n1} + w_{2} \cdot {\widetilde{R}}_{n2}\]</div>
<p>The modified count rate values <span class="math notranslate nohighlight">\({\widetilde{R}}_{nk} =\)</span>
<span class="math notranslate nohighlight">\(\widetilde{q} \cdot {\widetilde{R}}_{nk}\)</span> (<span class="math notranslate nohighlight">\(k\)</span>= 1,2)
lead to modified values
<span class="math notranslate nohighlight">\({\widetilde{R}}_{bk} = {\widetilde{R}}_{nk} + R_{0,k}\)</span> and
uncertainties
<span class="math notranslate nohighlight">\(u^{2}\left( {\widetilde{R}}_{b,k} \right) = {\widetilde{R}}_{b,k}/t_{b}\)</span>
of the gross count rates, from which the uncertainty
<span class="math notranslate nohighlight">\(u(\widetilde{A})\)</span> is derived, based on uncertainty propagation of equation
<a class="reference internal" href="#equation-eq-decay-chains-9">(4.14.9)</a>. This represents one iteration step in calculating the
detection limit. Values for the two „calibration factors“ <em>w1</em> and <em>w2</em>
are not always easily calculated, because they contain also elements of
the <span class="math notranslate nohighlight">\(\mathbf{F\ }\)</span>matrix. They can more generally be derived
numerically by the partial derivatives of the output quantity with
respect to the net count rates <span class="math notranslate nohighlight">\(R_{n,k}\)</span>:</p>
<div class="math notranslate nohighlight">
\[w_{k} = \frac{\partial A_{1}(0)}{\partial R_{n,k}}.\]</div>
</section>
<section id="implementation-of-decay-chains-in-uncertradio">
<h2><span class="section-number">4.14.4. </span>Implementation of decay chains in UncertRadio<a class="headerlink" href="#implementation-of-decay-chains-in-uncertradio" title="Link to this heading">¶</a></h2>
<p>The implementation requires an additional function for executing the
more complex calculations of decay corrections for a decay chain. A
function SDECAY is implemented in UncertRadio which is called within the
set of user-defined equations for the evaluation of the model. The
function call has the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Symb0</span> <span class="o">=</span> <span class="n">SDECAY</span><span class="p">(</span><span class="n">fmode</span><span class="p">,</span> <span class="n">tdiff</span><span class="p">,</span> <span class="n">tms</span><span class="p">,</span> <span class="n">avg</span><span class="p">,</span> <span class="n">Nstart</span><span class="p">,</span> <span class="n">Ndest</span><span class="p">,</span>
               <span class="n">SymbAct1</span><span class="p">,</span> <span class="n">SymAct2</span><span class="p">,</span> <span class="n">SymbAct3</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p><cite>SDECAY</cite> calculates a value and a standard uncertainty by using the
least-squares method outlined above, which are attributed to the
variable named Symb0 (which is an activity in Bq).</p>
<p>The meaning of the function parameters are explained in the following
table.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Variable</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>fmode</p></td>
<td><p>Forward calculation (=1) or backward calculation (=0),
starting from the respective activities; <em>integer</em></p></td>
</tr>
<tr class="row-odd"><td><p>tdiff</p></td>
<td><p>Time difference; <em>UR symbol</em></p></td>
</tr>
<tr class="row-even"><td><p>tms</p></td>
<td><p>Measurement duration; <em>UR symbol</em></p></td>
</tr>
<tr class="row-odd"><td><p>avg</p></td>
<td><p>Include (=1) or not (=0) the corrections for decay
during the measurement; <em>integer</em></p></td>
</tr>
<tr class="row-even"><td><p>Nstart</p></td>
<td><p>number of that decay chain member, from which on the
decay shall be considered (Nstart &gt;1) of if the full
decay chain si to be considered (Nstart=1); <em>integer</em></p></td>
</tr>
<tr class="row-odd"><td><p>Ndest</p></td>
<td><p>number of that decay chain member, the activity of which
shall be calculated; <em>integer</em></p></td>
</tr>
<tr class="row-even"><td><p>SymbAct1,
SymbAct2,
…</p></td>
<td><p>List of the UR activity symbols of the starting values
of the decay chain (fmode=1) or of the end values of the
decay chain (fmode=0); one may use more than the 3
activity symbols shown in the call</p></td>
</tr>
<tr class="row-odd"><td><p>Symb0</p></td>
<td><p>UR symbol of the arrays Messwert and StdUnc, to which
the SDECAY function value and standard uncertainty are
attributed to</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Bemerkung</p>
<p>the values of Nstart and Ndest always refer to the full decay
chain, even if Nstart &gt; 1 is selected.</p>
</div>
<p><strong>Example calls:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Symb0</span> <span class="o">=</span> <span class="n">SDECAY</span><span class="p">(</span><span class="n">fmode</span><span class="p">,</span> <span class="n">tdiff</span><span class="p">,</span> <span class="n">tms</span><span class="p">,</span> <span class="n">avg</span><span class="p">,</span> <span class="n">Nstart</span><span class="p">,</span> <span class="n">Ndest</span><span class="p">,</span> <span class="n">SymbAct1</span><span class="p">,</span> <span class="n">SymbAct2</span><span class="p">,</span> <span class="n">SymbAct3</span><span class="p">)</span>
</pre></div>
</div>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">cPb210_t1</span> <span class="pre">=</span> <span class="pre">SDECAY(0,</span> <span class="pre">t2minust1,</span> <span class="pre">tmBi210,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">cPb210_t2,</span> <span class="pre">cBi210_t2,</span> <span class="pre">cPo210_t2)</span></code></p>
<blockquote>
<div><p>“0“: (fmode): backward calculation;
“t2minusT1“: (diff) time difference t2 – t1;
“tmBi210“: (tms) counting duration (taken from Bi-210);
“0, 1, 1“ mean: “0“: (avg): without correcting decay during the
measurement; the first “1“: (Nstart) the decay chain starts from member
1; the second “1“: (Ndest) the decay chain member for which the activity
shall be calculated.</p>
<p>“From the activities of the three decay chain members (the last three
symbols within the call), given at the time t2, the activity of Pb-210
(the first member: Ndest=1) at t1 (fmode=0) is to be calculated without
correcting for decay during measurement; the measurement duration,
tmBi210, is not used.”</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">cPo210_t1</span> <span class="pre">=</span> <span class="pre">SDECAY(0,</span> <span class="pre">t2minust1,</span> <span class="pre">tmBi210,</span> <span class="pre">0,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">cPb210_t2,</span> <span class="pre">cBi210_t2,</span> <span class="pre">cPo210_t2)</span></code></p>
<blockquote>
<div><p>“0“: (fmode): backward calculation;
“t2minusT1“: (diff) time difference t2 – t1;
“tmBi210“: (tms) counting duration (taken from Bi-210);
“0, 2, 3“ mean: “0“: (avg): without correcting decay during the
measurement; “2”: (Nstart) the decay chain starts from member 2
(sub-chain Bi-210/Po-210); “3”: (Ndest) the third member of the full
decay chain for which the activity shall be calculated.</p>
<p>“The decay chain considered starts from the second member (i.e., the
chain Bi-210/Po-210). From the activities of the two decay chain members
of three (the last three symbols/parameters within the call), given at
the time t2, the activity of Po-210 (Ndest=3) at t1 is to be calculated
without correcting for decay during measurement; the measurement
duration, tmBi210, is not used.”</p>
</div></blockquote>
</li>
</ul>
<p>If a call of <cite>SDECAY</cite> is found in one or more equations, a decay chain
dialog is invoked:</p>
<img alt="../../_images/dialog_decay_chain_empty.png" src="../../_images/dialog_decay_chain_empty.png" />
<p>In the upper part of this dialog certain measurement related conditions
can be defined. A list box allows the selection of the decay chain from
some pre-defined decay chains, in this case, the chain
Pb-210/Bi-210/Po-210. The possible condition selections are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Is a chemical
separation
applied?</p></th>
<th class="head"><p>In the case of combined Sr-89/Sr-90 measurements:
yes, the separation of Y-90 from Sr-90</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>No. (1,2 or 3)
of the
radionuclide,
which is build
up since the
separation</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Common
measurement of
the decay chain
members on the
same detector?</p></td>
<td><p>May be yes in the case of beta-emitting
radionuclides; depends on the measurement design</p></td>
</tr>
<tr class="row-even"><td><p>Number of
counting
channels (energy
windows):</p></td>
<td><p>Usually 1; in the case of LSC measurements, there
may be used more than one channel</p></td>
</tr>
<tr class="row-odd"><td><p>Shall decay
constants be the
input quantities
instead of
half-lives?</p></td>
<td><p>Yes: decay constants used; No: half-lives used</p></td>
</tr>
</tbody>
</table>
<p>A few pre-defined decay chains are available in a file
<code class="file docutils literal notranslate"><span class="pre">List_DecaySeries.txt</span></code>, which is read by UR if required:</p>
<blockquote>
<div><p>List of available decay series:</p>
<p><code class="docutils literal notranslate"><span class="pre">Sr-90-2N</span> <span class="pre">:</span> <span class="pre">Sr-90</span> <span class="pre">#</span> <span class="pre">Y-90</span> <span class="pre">:</span> <span class="pre">z12=1</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Zr-95-3N</span> <span class="pre">:</span> <span class="pre">Zr-95</span> <span class="pre">#</span> <span class="pre">Nb-95m</span> <span class="pre">#</span> <span class="pre">Nb-95</span> <span class="pre">:</span> <span class="pre">z12=0.0108#</span> <span class="pre">z13=0.9892#</span> <span class="pre">z23=0.944</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Pb-210-3N</span> <span class="pre">:</span> <span class="pre">Pb-210</span> <span class="pre">#</span> <span class="pre">Bi-210</span> <span class="pre">#</span> <span class="pre">Po-210</span> <span class="pre">:</span> <span class="pre">z12=1#</span> <span class="pre">z23=1</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Pb-210-2N</span> <span class="pre">:</span> <span class="pre">Pb-210</span> <span class="pre">#</span> <span class="pre">Po-210</span> <span class="pre">:</span> <span class="pre">z12=1</span></code></p>
</div></blockquote>
<p>The structure of the file is simple:</p>
<blockquote>
<div><ul class="simple">
<li><p>every decay chain gets a short name (a string);</p></li>
<li><p>then the nuclide names follow, separated by the character #;</p></li>
<li><p>then the necessary branching ratios zji (with <span class="math notranslate nohighlight">\(j &lt; i\)</span>), which
are not zero.</p></li>
</ul>
</div></blockquote>
<p>With the button „Transfer selections to Grid“ pre-defined symbol names
are transferred to the grid for detection efficiencies (up to three when
using more than one counting channel) and chemical yields, which are
pre-defined from the radionuclide name. The columns of unused detection
efficiencies are left empty.</p>
<img alt="../../_images/dialog_decay_chain_example.png" class="align-center" src="../../_images/dialog_decay_chain_example.png" />
<p>Now, the pre-defined symbols in the table (grid) can be modified.
Thereafter, the symbols in the table are merged into the symbol list of
the UR project by using the button “implement the dialog data”. For
these symbols values and uncertainties have to be inserted in the TAB
„Values, uncertainties”.</p>
<p>For a further editing of this dialog at a later time, it can be
re-opened from the <strong>Menu Edit – Edit Decay chain</strong>.</p>
</section>
<section id="example-project">
<h2><span class="section-number">4.14.5. </span>Example project<a class="headerlink" href="#example-project" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">Pb210_Bi210_Po210_series_backwards_EN.txp</span></code></p></li>
</ul>
<p>A short description is included in this example project file.</p>
</section>
<section id="generation-of-decay-factor-formulas">
<h2><span class="section-number">4.14.6. </span>Generation of decay factor formulas<a class="headerlink" href="#generation-of-decay-factor-formulas" title="Link to this heading">¶</a></h2>
<p>In the case of radiochemical Sr-89/Sr-90 analyses, formulas for decay
factors need to be established. In beta radiation counting both Sr
isotopes, Sr-89 and Sr-90, contribute to the same count rate. The decay
of Sr-90 is accompanied by an ingrowth of its daughter product Y-90
which also contributes to the count rate. The complete formulas for this
application can already be complicated, especially, when corrections for
the decay during the measurement are included.</p>
<p>For such an application, UncertRadio supports the user by an additional
option for building these formulas as strings which are then transferred
into the text field in the dialog for defining the evaluation model of
decay curves.</p>
<p>This option can be invoked from the <strong>Menu Edit – Edit decay chain.</strong>
This option does not require an SDECAY function call within an UR
equation.</p>
<p>For the example mentioned at the begin of this section, the dialogs
layout is as follows:</p>
<img alt="../../_images/image594.jpg" class="align-center" src="../../_images/image594.jpg" />
<p>With the button <cite>Generate Xi formulas for decay curve fit model</cite> the
corresponding formula strings are generated and transferred in to the
associated text field of the model dialog.</p>
<p><strong>The (coded) result is the following:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X1</span> <span class="o">=</span> <span class="n">eSr90A</span> <span class="o">*</span> <span class="n">fd</span><span class="p">(</span><span class="n">tAs</span><span class="o">+</span><span class="n">tstart</span><span class="p">,</span><span class="n">tmess</span><span class="p">,</span><span class="n">lamSr90</span><span class="p">)</span> <span class="o">+</span> <span class="n">eY90A</span> <span class="o">*</span>  <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">lamSr90</span><span class="o">-</span><span class="n">lamY90</span><span class="p">)</span><span class="o">*</span> <span class="p">(</span> <span class="n">lamY90</span><span class="o">*</span>
      <span class="p">(</span> <span class="n">fd</span><span class="p">(</span><span class="n">tAs</span><span class="o">+</span><span class="n">tstart</span><span class="p">,</span><span class="n">tmess</span><span class="p">,</span><span class="n">lamY90</span><span class="p">)</span><span class="o">-</span><span class="n">fd</span><span class="p">(</span><span class="n">tAs</span><span class="o">+</span><span class="n">tstart</span><span class="p">,</span><span class="n">tmess</span><span class="p">,</span><span class="n">lamSr90</span><span class="p">))</span> <span class="p">)</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">eSr89A</span> <span class="o">*</span> <span class="n">fd</span><span class="p">(</span><span class="n">tAs</span><span class="o">+</span><span class="n">tstart</span><span class="p">,</span><span class="n">tmess</span><span class="p">,</span><span class="n">lamSr89</span><span class="p">)</span>
<span class="n">X3</span> <span class="o">=</span> <span class="n">eSr85A</span> <span class="o">*</span> <span class="n">fd</span><span class="p">(</span><span class="n">tAs</span><span class="o">+</span><span class="n">tstart</span><span class="p">,</span><span class="n">tmess</span><span class="p">,</span><span class="n">lamSr85</span><span class="p">)</span>
<span class="n">X4</span> <span class="o">=</span> <span class="n">eSr90B</span> <span class="o">*</span> <span class="n">fd</span><span class="p">(</span><span class="n">tAs</span><span class="o">+</span><span class="n">tstart</span><span class="p">,</span><span class="n">tmess</span><span class="p">,</span><span class="n">lamSr90</span><span class="p">)</span> <span class="o">+</span> <span class="n">eY90B</span> <span class="o">*</span>  <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">lamSr90</span><span class="o">-</span><span class="n">lamY90</span><span class="p">)</span><span class="o">*</span> <span class="p">(</span> <span class="n">lamY90</span><span class="o">*</span>
      <span class="p">(</span> <span class="n">fd</span><span class="p">(</span><span class="n">tAs</span><span class="o">+</span><span class="n">tstart</span><span class="p">,</span><span class="n">tmess</span><span class="p">,</span><span class="n">lamY90</span><span class="p">)</span><span class="o">-</span><span class="n">fd</span><span class="p">(</span><span class="n">tAs</span><span class="o">+</span><span class="n">tstart</span><span class="p">,</span><span class="n">tmess</span><span class="p">,</span><span class="n">lamSr90</span><span class="p">))</span> <span class="p">)</span>
<span class="n">X5</span> <span class="o">=</span> <span class="n">eSr89B</span> <span class="o">*</span> <span class="n">fd</span><span class="p">(</span><span class="n">tAs</span><span class="o">+</span><span class="n">tstart</span><span class="p">,</span><span class="n">tmess</span><span class="p">,</span><span class="n">lamSr89</span><span class="p">)</span>
<span class="n">X6</span> <span class="o">=</span> <span class="n">eSr85B</span> <span class="o">*</span> <span class="n">fd</span><span class="p">(</span><span class="n">tAs</span><span class="o">+</span><span class="n">tstart</span><span class="p">,</span><span class="n">tmess</span><span class="p">,</span><span class="n">lamSr85</span><span class="p">)</span>
<span class="n">X7</span> <span class="o">=</span> <span class="n">eSr90C</span> <span class="o">*</span> <span class="n">fd</span><span class="p">(</span><span class="n">tAs</span><span class="o">+</span><span class="n">tstart</span><span class="p">,</span><span class="n">tmess</span><span class="p">,</span><span class="n">lamSr90</span><span class="p">)</span> <span class="o">+</span> <span class="n">eY90C</span> <span class="o">*</span>  <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">lamSr90</span><span class="o">-</span><span class="n">lamY90</span><span class="p">)</span><span class="o">*</span> <span class="p">(</span> <span class="n">lamY90</span><span class="o">*</span>
      <span class="p">(</span> <span class="n">fd</span><span class="p">(</span><span class="n">tAs</span><span class="o">+</span><span class="n">tstart</span><span class="p">,</span><span class="n">tmess</span><span class="p">,</span><span class="n">lamY90</span><span class="p">)</span><span class="o">-</span><span class="n">fd</span><span class="p">(</span><span class="n">tAs</span><span class="o">+</span><span class="n">tstart</span><span class="p">,</span><span class="n">tmess</span><span class="p">,</span><span class="n">lamSr90</span><span class="p">))</span> <span class="p">)</span>
<span class="n">X8</span> <span class="o">=</span> <span class="n">eSr89C</span> <span class="o">*</span> <span class="n">fd</span><span class="p">(</span><span class="n">tAs</span><span class="o">+</span><span class="n">tstart</span><span class="p">,</span><span class="n">tmess</span><span class="p">,</span><span class="n">lamSr89</span><span class="p">)</span>
<span class="n">X9</span> <span class="o">=</span> <span class="n">eSr85C</span> <span class="o">*</span> <span class="n">fd</span><span class="p">(</span><span class="n">tAs</span><span class="o">+</span><span class="n">tstart</span><span class="p">,</span><span class="n">tmess</span><span class="p">,</span><span class="n">lamSr85</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/image595.jpg" src="../../_images/image595.jpg" />
</section>
<section id="decay-chain-literature">
<h2><span class="section-number">4.14.7. </span>Decay Chain Literature<a class="headerlink" href="#decay-chain-literature" title="Link to this heading">¶</a></h2>
<p>Levy, E.: <em>Decay chain differential equations: Solutions through matrix
analysis</em>. Computer Physics Communications, 2019, Vol. 234, S. 188-194.</p>
<p>[Blobel, Lohrmann, Kapitel 3.4]</p>
<p>Blobel, V., Lohrmann, E.: <em>Statistische und numerische Methoden der
Datenanalyse</em>. Teubner Studienbücher Physik. 1. Auflage. Stuttgart:
Vieweg+Teubner Verlag, 1998, 358 S. ISBN 978-3-519-03243-4</p>
<p>Kapitel 4.2 in:</p>
<p>Kanisch, G., Aust, M.-O., Bruchertseifer, F., Dalheimer, A., Heckel, A.,
Hofmann, S., et al.: <em>Bestimmung der charakteristischen Grenzen bei der
Aktivitätsbestimmung radioaktiver Stoffe – Teil 1: Grundlagen.</em> Version
Mai 2022. <em>CHAGR-ISO-01</em></p>
<p>In: Bundesministerium für Umwelt, Naturschutz, nukleare Sicherheit und
Verbraucherschutz, (Hrsg.): Messanleitungen für die Überwachung
radioaktiver Stoffe in der Umwelt und externer StrahIung. ISSN
1865-8725. Verfügbar unter: <a class="reference external" href="https://www.bmuv.de/WS1517">https://www.bmuv.de/WS1517</a></p>
<p>In Vorbereitung: Kanisch, G., Aust, M.-O., Bruchertseifer, F.,
Dalheimer, A., Heckel, A., Hofmann, S., et al.: <em>Zeitverhalten bei
mehrgliedrigen Zerfallsreihen.</em> Version Maixxx 2025. <em>ZERFALL/MEHRGL</em></p>
<p>In: Bundesministerium für Umwelt, Naturschutz, nukleare Sicherheit und
Verbraucherschutz, (Hrsg.): Messanleitungen für die Überwachung
radioaktiver Stoffe in der Umwelt und externer StrahIung. ISSN
1865-8725. Verfügbar unter: <a class="reference external" href="https://www.bmuv.de/WS1517">https://www.bmuv.de/WS1517</a></p>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;2025, Günter Kanisch.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../_sources/doc_files/special_methods/decay_chains.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/OpenBfS/UncertRadio" class="github">
        <img src="../../_static/github-banner.svg" alt="Fork me on GitHub" class="github"/>
    </a>
    

    
  </body>
</html>