Program installation notes
==========================

Download
--------

The software download consists of an executable setup installation
program:

Setup_UR2_vers_2.4.xx_64bit.exe (with variable version number; ca. 25.0
MB)

The UncertRadio example projects given in German and English language
are copied to the sub-folders pros\\de und pros\\en.

Installation
------------


**Since version 2.5 UncertRadio can be compiled from the sources.
Binarys for Windows are provided as well.**

**Step 1:**

Before starting the installation, it is recommended to re-name the
previous directory, e.g. d:\\UR2 before installing a new version. If the
same path is used for the next installation, the unins000.exe (see step
1) should be applied in advance.

**Step 2:**

Execution of the executable Setup_UR2_Vers_xxx.exe, which at the begin
allows to select the UR2 working directory. Consider the following
before execution:

   If the selected UR2 directory already existed before this
   installation, the old program elements/files (including sub-folders)
   have to be removed before starting the above Setup installation
   program.

   If the previous installation had already been implemented with this
   installation program (Setup_UR2\*.exe), the UR2 directory contains a
   program

   unins000.exe (uses unins000.dat for the files to be deleted).

   Executing this removes the files/directories of the previous
   installation, but leaves the user-modified or user-added files.

The folder GTKuser64 is installed as sub-directory of the UR2 directory.

During installation entries are added to the windows registry; they are,
however, removed when executing unins000.exe.

**Step 3:**

The three files

UR2_cfg.dat

settings.ini

UR2_SingleAutoRun_V11.xlsm

are copied during the installation of step 2, but ONLY, if they do not
yet exist in the selected UR2 directory.

**Step 4:**

Notes about editing of Windows environment variables are given in the
file InfoPath_Var_en.txt.

Editing of windows registry entries is not performed during the
installation.

**Subsequent de-installation:**

By executing the setup installation program, the following two files are
copied to the UR2 directory:

unins000.exe (uses unins000.dat for the files to be deleted).

With executing unins000.exe all files and sub-directories are removed,
which were previously installed by that installation program. Files, not
installed by the installation program, or modified after that, are not
removed.


Program start
-------------

**UncertRadio may not start due to insufficient rights**

If Windows does not allow starting Uncertradio.exe from the Windows
Explorer, the program can be started with the batch file UR2_start.bat,
as experienced by interested users (Thanks to them!):


**Program does not start or exits with a runtime error message**

If at starting the program a Windows message appears, which indicates
the error code (0xc000007b), this means, that Windows found a 32-bit
version of a DLL file not related to UncertRadio instead of the 64-bit
version. Then, the environment variable PATH should be checked.

During the initial phase of starting UR2 a small text file is written:
fort.66 (not to be mixed up with Fort66.txt), which can give hints about
the reasons of a non-successful start.

Example for fort.66 (see next below) :

The first line shows the command string created by Windows, with or
without full path. For an indirect start by double clicking on a project
file (.txp) being linked to UncertRadio.exe, it contains additionally
the project filename including its path. The parameter wpunix is no
longer used.


**Note about linking project files (.txp) to UncertRadio.exe**

Linking the file type .txp to UncertRadio.exe, or better UR2_start.bat,
can be established as follows in Windows:

-  highlight a txp file, click by the left mouse button “open with“ and
   select “other app”;

-  set the check mark and click on “further Apps“;

-  scroll down the list of recommended applications;

-  click on “search another App on this PC“;

-  select the desired Application, Uncertradio.exe or better
   UR2_start.bat , with the explorer;

-  clicking “enter” may at first lead to a crash of the starting
   UncertRadio, with Runtime error message: ignore this.

With the next double click on the txp filename the program should start
successfully.

If such links to earlier versions of UncertRadio.exe exist, the
probability is large that a double click on a txp file will invoke an
older version of the program. This is a known Windows problem which can
be searched for in the internet. Opening the text file “fort66.txt“ can
help in clarification; it contains as the first line the command string
generated by the link, for example,

D:\\test_UR2\\UncertRadio.exe D:\\GF_Pros\\UR2\\
ISO-Example-1a_EN.txp.txp

The path shown at the left-most is the one of that UncertRadio version
which was actually started.

When the wrong UR-Version was invoked, it may be necessary to remove the
txp file type within the Windows registry and to repeat the step of
re-establishing the link. It is strongly recommended to contact the
local IT group for editing the Windows registry! The path of interest in
the registry is:

HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Current
version\\Explorer\\FileExts

**Note on the use of the Excel-controlled processing of UncertRadio**

The Excel file

UR2_SingleAutoRun_V11.xlsm

(since UR2 version 2.4.03) has changed compared to that file used by the
previous version by extending the filenames to always include the
complete path. A further evaluation button “Start (autosep)” was added;
see chapter 5.2. The treatment of VBA errors has been slightly improved.
The Excel file can be used in the 32-bit as well as the 64-bit versions
of MS Office/Excel; see the notes in the introduction part of the VBA
module (Modul_Auto_single_UR) within the Excel file.

The VBA module of the Excel file now interprets an UncertRadio exit code
which has been introduced with version 2.2.03. An exit code equal to 3
(error occurred during the UncertRadio run) leads to an abortion of the
running VBA module.

**Configuration file UR2_cfg.dat:**

+------------------------------+---------------------------------------+
| [UncertRadio configuration]  | modifiable folder names:              |
|                              |                                       |
| [Path]                       | folder containing the CHM Help file   |
|                              | (**local drive!!**)                   |
| UR_path=D:\\UR2\\            |                                       |
|                              | folder with the Excel file for        |
| Help_path=D:\\UR2\\          | automatic processing of UR2:          |
|                              |                                       |
| Excel_Auto_path=D:\\UR2\\    | not used by now                       |
|                              |                                       |
| U                            | folder into which UR writes its AUTO  |
| R_AUTO_output_path=D:\\UR2\\ | output.                               |
|                              |                                       |
| [Local]                      | If the value of UR_AUTO_output_path   |
|                              | is left empty, it receives the path   |
| Decimal_point=               | name by UR taken from the call to UR  |
|                              | with the Excel file.                  |
| List_separator=;             |                                       |
|                              | Only if the UR output shall NOT be    |
| Language=EN                  | written into this Excel path, the     |
|                              | value of UR_AUTO_output_path must not |
| Monitor#=0                   | be empty.                             |
|                              |                                       |
| ContrastMode=F               | If the contrast mode of the program   |
|                              | windows is needed temporarily, it can |
| winRelSizeWidth=0.7          | also be activated in the Options      |
|                              | dialog.                               |
| winRelSizeHeight=0.9         |                                       |
|                              | Ratio of window width to full monitor |
|                              | width                                 |
|                              |                                       |
|                              | Ratio of window height to full        |
|                              | monitor height                        |
|                              |                                       |
|                              |    The older dentry „windowRelSize=X“ |
|                              |    is internally interpreted as       |
|                              |    „winRelSizeWidth=X“ and            |
|                              |    „winRelSizeHeight=X“.              |
+==============================+=======================================+
+------------------------------+---------------------------------------+

The entry “Monitor#=1“ was introduced with Version 2.3.08; see the
paragraph “Using several monitors“ at the end of this section.

After program start, the window can be enlarged using the mouse,
however, with the next action, it turns back to the previous first
window size.

**Country specific parameters**

The parameters found in the configuration file UR2_cfg.dat under the
item [Local] may be defined as follows.

a) one may omit the parameter values following the „=“ character:

Decimal_point=

   List_separator=

   Language=

First, the country language is selected from the Windows system, i.e.
DE, EN or FR. EN is also selected if another language should occur.

From this, the values for the decimal point character and the list
separator character (for CSV files) are selected:

DE or FR: comma as decimal point; semicolon as list separator character

   EN: point as decimal point; comma as list separator character

   note: The language which can be selected in the main menu - Options
   is only temporarily used, i.e., only within the actual program run.

   The language shortcut, i. e., the argument of language= , must be
   entered definitely since version 2.2.03. If it is missing the program
   assumes EN.

   **Since Version 2.2.07 the language shortcut is taken from the
   language which has been selected at the beginning of executing the
   setup program.**

b) If other specifications are desired, their parameter values can be
   inserted directly after the “=“-sign in the configuration file. It
   may be sufficient to insert explicitly only the desired list
   separator character:

..

   List_separator=;

c) The language can also be selected in the dialog of the menu item
   „Options – Pre-settings“ after the program has already been started
   (but only temporarily; see above). From the language defined there,
   the characters for decimal point and list separator are determined in
   the way as described above under a). Additionally, the list separator
   character can there be selected there explicitly.

d) For a graphical presentation the decimal point character is
   determined by the language shortcut DE, EN or FR; a manual change of
   the country/language within Windows is not necessary.


**Choosing the language**

The **user** of UncertRadio can be **guided** by the program through its
various dialogs **in the necessary language**, which can be chosen
between German, English and French. This is controlled via the entry
’language=’ in the above-mentioned configuration file UR2_cfg.dat, which
is read at every program start. The parameter values are:

DE for German,

EN for English,

FR for French.

Changing the language is even easier and safer by using the start file

UR2_start.bat:

   ECHO OFF

   Path = D:\\UR2\\GTKuser64\\bin; %path%

   SET LANG=en_EN

   START /min D:\\UR2\\uncertradio.exe %1

An entry SET LANG=de_DE enables Windows to use (temporarily) the German
language; after the batch file is finished, Windows will use the English
language again.

**Since the version 2.3.07**, based on the ’language=’ entry in the file
UR2_cfg.dat, the command **“SET LANG=de_DE“** (or =fr_FR) as part of the
start file shown above, is used **directly within the program**. Thus,
the start file is no longer necessary, at least, if only the language
shall be changed. For the language entry DE, the internal command “SET
LANG=de_DE“ is used which translates the user dialogs into German. This
command is not temporarily; before terminating the program, the language
is switched back to the previously applied language (English). The
latter, however, cannot be done in the case of a program crash; then the
language should be reset manually, e.g. with “SET LANG=en_EN“ in a
Windows command window.

The language can be switched within the running program with using the
dialog “Menu – Options – Pre-settings“. Since **Version 2.3.07,** this
**includes also** **those ”GTK stock buttons“**, labelled by an icon and
text, which previously were translated only after a new program start.
This has been achieved by converting all “stock buttons“ into normal
buttons; the form of the button icons changed, but only slightly. For
the more complex GTK file chooser dialog, most items are translated, but
not all.

**Configuration file settings.ini:**

[Settings]

gtk-theme-name = win64

gtk-font-name = Sans Normal 10

In this file related to the GTK3-GUI only the entry

gtk-font-name = Sans Normal 10

is allowed to be modified, which defines the font-type and its size.

Using several monitors
^^^^^^^^^^^^^^^^^^^^^^

Up to now, UncertRadio assumed that a single monitor was used for
working. Internally. the range of coordinates (pixel) of 1 monitor
covered the whole screen. For this case, the entry “Monitor#=0” as just
introduced above in the UR2_cfg.dat configuration file can be omitted.

Meanwhile, working with more than one monitor is becoming more
attractive. In that case, the screens range of coordinates covers all
corresponding monitor coordinate ranges. The screen is considered as an
envelope rectangular region covering all individual monitor coordinate
rectangles. The attribution to a single monitor rectangle is given by
the screen-related coordinates of the monitor. A coordinate x is
attributed to the width and a coordinate y the height. x=0 defines the
left limit and y=0 the upper limit of the screen rectangle; the two
coordinate axes are directed from left to right (x) and from top to
bottom (y). Within the program, a monitor rectangle is constructed from
its upper-left corner coordinates and the sizes of its width and height.

The following Figure shows to possible screen/monitor configurations.

+-----------------------------------------------------------+----------+
| |Ein Bild, das Uhr enthält. Automatisch generierte        | screen:  |
| Beschreibung|                                             |          |
|                                                           | 2560 x   |
|                                                           | 1656     |
|                                                           |          |
|                                                           | (Monitor |
|                                                           | 2 nicht  |
|                                                           | aktiv)   |
+===========================================================+==========+
|                                                           |          |
+-----------------------------------------------------------+----------+
| |Ein Bild, das Screenshot enthält. Automatisch generierte | screen:  |
| Beschreibung|                                             |          |
|                                                           | 5760 x   |
|                                                           | 1200     |
+-----------------------------------------------------------+----------+
|                                                           |          |
+-----------------------------------------------------------+----------+

In UncertRadio, since Version 2.3.08, the screen size, the number of
monitors and their rectangle coordinates are determined by GDK functions
during the initial starting phase. The values obtained can be found in
the file fort66.txt, given in the following form (shown here for only
several monitors).

------------------------------------------------------------------------------

coordinates: width x height

\**\* Screen: 3200 x 1776

PixelxZoom=120 PixelyZoom=120

\**\* Monitors:

\**\* 1 Ranges (geom): (1920 - 2560) x (0 - 480) scaling fact= 1.25

\**\* 1 Ranges (geom): (0 - 1920) x (480 - 1680) scaling fact= 1.25

\**\* 1 Ranges (geom): (1920 - 2560) x (0 - 480) scaling fact= 1.25

\**\* # of monitors: 3

\**\* Monitor number selected as given in UR2_cfg.dat: 2

\**\* Primary monitor # = 1

\**\* Selected monitor: 1; Screen min-max horiz.: 1 - 1919 min-max
vertical: 482 - 1642

(und etwas weiter unten)

\**\* Main window: first Show: upper-left pos: mposx,mposy= 96 532

\**\* Main window: Monitor# at mposx+10,mposy+10= 1

\**\* Main window: width= 983 height= 713

------------------------------------------------------------------------------

There are still two problems.

The width and height values taken from the table above, can include a
scaling factor being set in Windows 10, e.g., 1.25 for a Windows 10
scaling of 125 %. UncertRadio‘s determination of this factor from
Windows 10 may not be safe by now. The scaling in Windows is based on a
value of 96 DPI (dots per inch), which is taken there to define a 100 %
scaling. If a user has selected e.g. a scaling of 125 %, this is stored
as “LogPixels“ within the Windows registry as a value being smaller by a
factor 0.96, i.e. 120 %.

Furthermore, the monitor numbers attributed by UncertRadio can differ
from those defined within Windows 10. Windows 10 also allows graphical
re-arranging of monitors.

Addressing one of the monitors is performed by its number. The monitor
number can be set **in the file UR2_cfg.dat** by the following entry
(here set to 1):

Monitor#=1

After having defined the monitor number, it may happen that the
UncertRadio window does not appear at its expected screen location.
Then, testing different monitor numbers is required.

After the UncertRadio window has been built completely, the number of
the monitor really being used can be displayed with the **Menu – Options
– Monitor#**. For this query, the number of that monitor is obtained, in
the rectangle of which the upper-left part of the UR window lies.

One of two versions before 2.3.08, a programmed re-positioning or
re-sizing could occur. As the coordinates required for this operation
were derived from the screen, one could observe in the case of more than
one monitor, that the UR window was wider than the width of the actual
monitor. In addition, such an oversized window could not be downsized.

**Note**: The application of **working with several monitors** within
UncertRadio **is still in a test phase**.

**According to the present state, the following steps are recommended.**

There are three options available for the UR2_cfg.dat file if **only one
monitor** is connected to the PC:

   | a) apply the entry “Monitor#=0“, or
   | b) omit this entry, or
   | c) apply “Monitor#=1“ (in this case the separation of the MC
     graphics window is better separated from the UncertRadio window).

In the case of **more than one monitor** one should first try the
options a) or b).

If the UncertRadio window does not appear on the desired monitor, the
appropriate entry “Monitor#=” in UR2_cfg.dat can only be found by trial.

In the present state, UncertRadio tries to find from Windows the
appropriate coordinate values of the monitor **by the following
algorithm**. The first step is to read the scaling, the parameter
LogPixels, where LogPixels = 96 is defined as 100 %. UncertRadio has
then a table of 20 possible width/height combinations of a monitor
available. With the monitor coordinates read from Windows, it first
tries to find a combination from the table exactly matching these
coordinates without taking scaling into account. If this fails, in a
second step the monitor coordinates are reduced by the scaling factor
(dividing by (LogPixels/96)) and then selects from the 20 width/height
combinations that one with the closest agreement.

1.4 Program version and application note
----------------------------------------

+-------------------------------------------------------+--------------+
| |image1|                                              |              |
+-------------------------------------------------------+--------------+

The Windows program UncertRadio is provided **free of charge**.

The program was developed by the author following state-of-the-art of
science, standardization and technology. Nevertheless, NO GUARANTEE for
the correctness of the user’s own results obtained with UncertRadio is
given.

Information on possible errors in the program is highly appreciated!

**UncertRadio** is well suited for comparison calculations, e.g., for
comparison with spreadsheet-based calculations.

1.5 UR Help and network drives
------------------------------

The Windows Help file UR2_HELP_EN.CHM, of the program cannot be used
from a network drive because of Windows safety reasons. Therefore, it is
recommended to install UR incl. its Windows Help on a local drive.
However, it would be sufficient to move only the CHM Help file to a
local drive. Within the configuration file UR2_cfg.dat its full pathname
can be defined by the entry Help_path=.

The following may also be recommended:

-  Open the context menu »Properties« by clicking on the CHM file with
   the RIGHT mouse button;

-  open the tab »Safety«; therein, a text like » This file came from
   another computer and might be blocked to help protect this computer«
   is shown;

-  click the button for allowing access.